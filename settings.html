<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - apaPong</title>
    <link rel="stylesheet" href="css/settings.css">
</head>
<body>
    <div class="container">
        <h1 class="settings-title">Settings</h1>
        
        <div class="settings-section">
            <h2 class="section-title">Ball Color</h2>
            <div class="preview-ball" id="previewBall"></div>
            
            <div class="color-grid" id="colorGrid">
                <!-- Colors will be generated by JavaScript -->
            </div>
        </div>
        
        <button class="back-button pixel-button" onclick="window.location.href='index.html'">Back to Menu</button>
    </div>
    
    <script>
        // Color options
        const colors = [
            { name: "White", color: [255, 255, 255] },
            { name: "Red", color: [255, 100, 100] },
            { name: "Blue", color: [100, 200, 255] },
            { name: "Green", color: [100, 255, 100] },
            { name: "Yellow", color: [255, 255, 100] },
            { name: "Purple", color: [200, 100, 255] },
            { name: "Orange", color: [255, 150, 50] },
            { name: "Pink", color: [255, 150, 200] },
        ];
        
        // Default ball color
        const DEFAULT_BALL_COLOR = [255, 255, 255];
        
        // Get current ball color from localStorage or default
        function getCurrentBallColor() {
            const saved = localStorage.getItem('ballColor');
            if (saved) {
                try {
                    return JSON.parse(saved);
                } catch (e) {
                    return DEFAULT_BALL_COLOR;
                }
            }
            return DEFAULT_BALL_COLOR;
        }
        
        // Save ball color
        function saveBallColor(color) {
            localStorage.setItem('ballColor', JSON.stringify(color));
        }
        
        // Update preview ball
        function updatePreviewBall(color) {
            const previewBall = document.getElementById('previewBall');
            if (previewBall) {
                previewBall.style.backgroundColor = `rgb(${color[0]}, ${color[1]}, ${color[2]})`;
            }
        }
        
        // Check if color is selected
        function isColorSelected(color1, color2) {
            return color1[0] === color2[0] && 
                   color1[1] === color2[1] && 
                   color1[2] === color2[2];
        }
        
        // Create color buttons
        function createColorButtons() {
            const colorGrid = document.getElementById('colorGrid');
            if (!colorGrid) return;
            
            const currentColor = getCurrentBallColor();
            updatePreviewBall(currentColor);
            
            colors.forEach((colorOption) => {
                const isSelected = isColorSelected(currentColor, colorOption.color);
                
                const colorButton = document.createElement('button');
                colorButton.className = `color-button pixel-button ${isSelected ? 'selected' : ''}`;
                colorButton.style.backgroundColor = `rgb(${colorOption.color[0]}, ${colorOption.color[1]}, ${colorOption.color[2]})`;
                colorButton.textContent = colorOption.name;
                colorButton.setAttribute('data-color', JSON.stringify(colorOption.color));
                
                colorButton.addEventListener('click', () => {
                    const newColor = colorOption.color;
                    saveBallColor(newColor);
                    updatePreviewBall(newColor);
                    
                    // Update button states
                    document.querySelectorAll('.color-button').forEach(btn => {
                        btn.classList.remove('selected');
                    });
                    colorButton.classList.add('selected');
                });
                
                colorGrid.appendChild(colorButton);
            });
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            createColorButtons();
            
            // Load saved color
            const savedColor = getCurrentBallColor();
            updatePreviewBall(savedColor);
        });
        
        // ESC key handling
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                window.location.href = 'index.html';
            }
        });
    </script>
</body>
</html>

